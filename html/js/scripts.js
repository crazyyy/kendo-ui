function ParseAndBuildMap(e,a){var t="https://api.foursquare.com/v2/venues/search?client_id="+fsqId+"&client_secret="+fsqSecret+"&v=20150717&ll=cordCenter&query=searchQuery&callback=?".replace("searchQuery",searchQuery);console.log(t),$.getJSON(t.replace("cordCenter",e+","+a),function(t,o){if("success"!==o)return alert("Request to Foursquare failed");for(var n=0;n<t.response.venues.length;n++){var r=t.response.venues[n];dataStFull.push({name:r.name,latlng:[r.location.lat,r.location.lng]})}var l=new kendo.data.DataSource({data:dataStFull});MapDrawer(e,a,l)})}function MapDrawer(e,a,t){$("#map").kendoMap({center:[parseFloat(e),parseFloat(a)],zoom:14,layers:[{type:"tile",urlTemplate:"http://#= subdomain #.tile2.opencyclemap.org/transport/#= zoom #/#= x #/#= y #.png",subdomains:["a","b","c"],attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap contributors</a>.Tiles courtesy of <a href="http://www.opencyclemap.org/">Andy Allan</a>'},{type:"marker",dataSource:t,locationField:"latlng",titleField:"name"}],click:OnClickMap})}function OnClickMap(e){var a=parseFloat(e.location.lat),t=parseFloat(e.location.lng);ParseAndBuildMap(a,t)}function GoogleMapAutocomplite(){var e=document.getElementById("searchTextField"),a=new google.maps.places.Autocomplete(e);google.maps.event.addListener(a,"place_changed",function(){var e=a.getPlace(),t=e.geometry.location.lat(),o=e.geometry.location.lng();ParseAndBuildMap(t,o)})}function GetCurrentLocation(){function e(e){var a=e.coords,t=a.latitude,o=a.longitude;ParseAndBuildMap(t,o)}function a(e){console.warn("ERROR("+e.code+"): "+e.message)}if(ParseAndBuildMap(centerLat,centerLng),Modernizr.geolocation){navigator.geolocation.getCurrentPosition(e,a,t);var t={enableHighAccuracy:!0,timeout:5e3,maximumAge:0}}else console.log("location error")}var fsqId="2TVA3RGPADXOJJPZY4VBRWZPJ0GNBLLKLMGEL1VTARBDJ1TV",fsqSecret="FK40OEGZ1ODV1GM1C0SYMB3QYN5LYECMJ0L0JGJWRXAB5WQS",centerLat="49.233083",centerLng="28.46821699999998",dataStFull=[],searchQuery="ресторан";google.maps.event.addDomListener(window,"load",GoogleMapAutocomplite),$(document).ready(GetCurrentLocation);var searchButton=document.getElementById("clicker");searchButton.addEventListener("click",function(){var e=document.getElementById("searchCategories").value;console.log("--------"),console.log(e),ParseAndBuildMap(centerLat,centerLng,e)},!1);